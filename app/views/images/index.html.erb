<h3>Search</h3>

<%= form_tag image_gallery_path(1), :method => 'get' do %>
   <text>Object:</text>
   <%= select_tag :search_btype, options_for_select([["Select body type", ""],
                                                "Comet",
                                                "Meteor",
                                                "Not Defined",
                                                "Galaxy",
                                                "Satellite",
                                                "Star"], 
                                                params[:search_btype]) %><br />

   <text>Date:</text>
   <%= date_field_tag :search_date, params[:search_date],
                     "data-provide" => 'datepicker' %><br />
   <%= submit_tag "Search" %>
<% end %>

<!-- Photo gallery grid -->

<br />
<div align = "center">
<h3 class>Gallery</h3>
<div id = "grid">
   <% @Images.each do |t| %>
      <div class = "grid-element" >
         <p><b><%= t.title %></b></p>
         <% if t.attachment.file.identifier == "no_image" ||  t.attachment.file.identifier == nil %>
            <%= link_to image_tag("/uploads/image/img-not-found-200x180"), 
                                         image_show_path(t) %>
         <% else %>
            <%= link_to image_tag(t.attachment_url(:thumb)), image_show_path(t) %>
         <% end %>
      </div>
   <% end %>
</div>

<div class = "clear"></div>

<!-- Working out variables for pagination -->

<% if params.has_key?(:id) %>
   <% page = params[:id] %>
<% else %>
   <% page = "1" %>
<% end %>

<% max_pages = (@AvailableImages.to_f/9).ceil %>

<nav>
   <ul class = "pagination">

   <!-- Previous page -->
   <% if page == "1" %>
      <li class = "page-item disabled">
      <% previous_page = 1 %>
   <% else %>
      <li class = "page-item">
      <% previous_page = page.to_i - 1 %>
   <% end %>
      <%= link_to("<", image_gallery_path(previous_page,
                     :search_btype => params[:search_btype],
                     :search_date => params[:search_date]), 
                     class: "page-link") %>
   </li>

   <!-- Show current page -->
   <li class = "page-item active"><%= link_to(page, image_gallery_path(page.to_i), class: "page-link") %></li>

   <!-- Next page -->
   <% if page == max_pages.to_s %>
      <li class = "page-item disabled">
      <% next_page = max_pages %>
   <% else %>
      <li class = "page-item">
      <% next_page = page.to_i + 1 %>
   <% end %>  
      <%= link_to(">", image_gallery_path(next_page,
                     :search_btype => params[:search_btype],
                     :search_date => params[:search_date]),
                     class: "page-link") %>
   </li>
   </ul>
</nav>
</div>